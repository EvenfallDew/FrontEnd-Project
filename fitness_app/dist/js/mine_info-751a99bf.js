!function(){"use strict";var e={866:function(e,t,n){n.r(t)},621:function(e,t,n){n.r(t)}},t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(866),n(621),$utils.load(1400),document.ready((function(){var e,t=JSON.parse(localStorage.getItem("user")).userId,n=document.querySelector("#showSexPicker"),o=document.querySelector("#showBirthdayPicker"),r=document.querySelector("#showProvincePicker"),i=document.querySelector("#showCityPicker"),a=document.querySelector("#sex"),u=document.querySelector("#birthday"),c=document.querySelector("#province"),l=document.querySelector("#city"),s=document.querySelector("#nickName"),d=document.querySelector("#signArea"),f=document.querySelector("#signNum"),m=document.querySelector("#saveBtn"),v=[],g=[];n.addEventListener("click",(function(){weui.picker([{label:"男",value:0},{label:"女",value:1},{label:"不详",value:2}],{onConfirm:function(e){a.textContent=e[0].label},title:"请选择性别"})})),o.addEventListener("click",(function(){weui.datePicker({start:1949,end:(new Date).getFullYear(),onConfirm:function(e){u.textContent=e.map((function(e){return $utils.padZero(e.value)})).join("-")},title:"请选择生日"})})),r.addEventListener("click",(function(){weui.picker(v,{onConfirm:function(e){c.textContent=e[0].label,l.textContent="请选择",axios.get($utils.BASE_URL+"/address/city/"+e[0].value).then((function(e){var t=e.data;0==t.status&&(g=t.data.map((function(e){return{label:e.name,value:e.addressId}})))})).catch((function(e){console.log(e)}))},title:"请选择省份"})})),i.addEventListener("click",(function(){"请选择"==c.innerHTML?c.click():weui.picker(g,{onConfirm:function(e){l.textContent=e[0].label},title:"请选择城市"})})),axios.get($utils.BASE_URL+"/address/province").then((function(e){var t=e.data;if(0==t.status){var n=JSON.parse(localStorage.getItem("user"));if(null!=n.address){var o=function(e,t){for(var n=0;n<t.length;n++)if(t[n].name==e)return t[n].addressId}(n.address.split(",")[0],t.data);axios.get($utils.BASE_URL+"/address/city/"+o).then((function(e){var t=e.data;0==t.status&&(g=t.data.map((function(e){return{label:e.name,value:e.addressId}})))})).catch((function(e){console.log(e)}))}v=t.data.map((function(e){return{label:e.name,value:e.addressId}}))}})).catch((function(e){console.log(e)})),d.addEventListener("input",(function(){f.textContent=this.value.length})),e=JSON.parse(localStorage.getItem("user")),s.value=e.nickname,a.textContent=e.gender?e.gender:"请选择",u.textContent=e.birthday?$utils.formatDate(e.birthday):"请选择",c.textContent=e.address?e.address.split(",")[0]:"请选择",l.textContent=e.address?e.address.split(",")[1]:"请选择",d.value=e.sign,f.textContent=null!=e.sign?e.sign.length:"0",m.addEventListener("click",(function(){axios.post($utils.BASE_URL+"/users/userEdit",{nickname:s.value,gender:"请选择"==a.textContent?"请选择":a.textContent,birthday:"请选择"==u.textContent?$utils.formatDate(new Date):u.textContent,address:[c.textContent,l.textContent],sign:d.value,userId:t}).then((function(e){0==e.data.status&&($utils.showToast("icon-toast-correct","修改成功",2e3),setTimeout((function(){$utils.out(),setTimeout((function(){location.href="./mine.html"}),1e3)}),2e3))})).catch((function(e){console.log(e)}))})),document.querySelector("#mineLink").addEventListener("click",(function(e){e.preventDefault(),$utils.out(),setTimeout((function(){location.href="./mine.html"}),1e3)}))}))}();