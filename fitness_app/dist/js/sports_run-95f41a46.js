!function(){"use strict";var e={137:function(e,t,n){n.r(t)}},t={};function n(o){if(t[o])return t[o].exports;var l=t[o]={exports:{}};return e[o](l,l.exports,n),l.exports}n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(137),$utils.load(1400),document.ready((function(){$utils.commonHeader(),$utils.commonFooter();var e=JSON.parse(localStorage.getItem("user")).userId,t=document.querySelector("#goBtn"),n=document.querySelector("#runKm"),o=document.querySelector("#map"),l=document.querySelector("#maskTime"),a=document.querySelector("#maskData"),i=document.querySelector("#mapMask"),s=document.querySelector("#timeNum"),c=document.querySelector("#takeTime"),r=document.querySelector("#continueBtn"),u=document.querySelector("#pauseBtn"),d=document.querySelector("#stopBtn"),y=document.querySelector("#iconLocation"),m=document.querySelector("#backBtn"),p=document.querySelector("#finishBtn"),S=document.querySelector("#nowDate"),f=document.querySelector("#mapSpeed"),v=document.querySelector("#mapTakeTime"),x=document.querySelector("#mapCalorie"),g=document.querySelector("#nowKm"),q=document.querySelector("#cardRunKm"),C=document.querySelector("#speed"),k=document.querySelector("#calorie"),T=0,$=null,h=new BMap.Map("mapMode"),B=1e-4,w=1e-4,M=[],b=0,L=0;function E(){clearInterval($),$=setInterval((function(){T++,c.textContent=$utils.secondToHms(T),v.textContent=$utils.secondToHms(T),P()}),1e3)}function P(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new BMap.Geolocation;t.getCurrentPosition((function(t){if(this.getStatus()==BMAP_STATUS_SUCCESS){var n=parseFloat(t.longitude),o=parseFloat(t.latitude);if(1==e&&(n+=B,o+=w,B+=$utils.randomNum(1e-4,5e-4),w+=$utils.randomNum(1e-4,5e-4),M.push({lng:n,lat:o}),M.length>1)){var l=M[M.length-2],a=M[M.length-1];$utils.drawLine(h,l,a),b+=1*$utils.calcDistance(l,a),g.textContent=b.toFixed(2),q.textContent=b.toFixed(2);var i=$utils.calcPace(b,T);C.textContent=i,f.textContent=i,L=$utils.calCalorie(b),k.textContent=L,x.textContent=L}var s=new BMap.Point(n,o);h.centerAndZoom(s,18)}else $utils.showToast("icon-toast-wrong","获取位置失败",2e3)}))}S.textContent=$utils.formatDate(new Date),axios.get($utils.BASE_URL+"/sports/exerciseData?id="+e).then((function(e){var t=e.data;0==t.status&&(n.textContent=t.data.runkm)})).catch((function(e){console.log(e)})),function(){var e=new BMap.Map(o);(new BMap.Geolocation).getCurrentPosition((function(t){if(this.getStatus()==BMAP_STATUS_SUCCESS){var n=t.longitude,o=t.latitude,l=new BMap.Point(n,o);e.centerAndZoom(l,12)}else alert("failed"+this.getStatus());document.querySelector(".anchorBL").style.display="none"}))}(),t.addEventListener("click",(function(){l.style.display="block";var e=[3,2,1,"GO"],t=0;s.textContent=e[t];var n=setInterval((function(){t++,s.textContent=e[t],t==e.length&&(clearInterval(n),l.style.display="none",a.style.display="block",E())}),1e3)})),u.addEventListener("click",(function(){clearInterval($),u.style.display="none",r.style.display="flex",d.style.display="flex"})),r.addEventListener("click",(function(){E(),this.style.display="none",d.style.display="none",u.style.display="flex"})),d.addEventListener("click",(function(){i.style.display="block",p.style.display="block",m.style.display="none",P(!1)})),y.addEventListener("click",(function(){i.style.display="block",m.style.display="block",p.style.display="none",P(!1)})),m.addEventListener("click",(function(){i.style.display="none"})),p.addEventListener("click",(function(){clearInterval($),c.textContent=$utils.secondToHms(T),v.textContent=$utils.secondToHms(T),axios.post($utils.BASE_URL+"/sports/save",{id:e,type:1,takeTime:T,miles:b,averagerate:(b/T).toFixed(2),calorie:L}).then((function(e){0==e.data.status?($utils.showToast("icon-toast-correct","保存成功",2e3),setTimeout((function(){T=0,$utils.out(),setTimeout((function(){i.style.display="none",a.style.display="none",u.style.display="flex",r.style.display="none",d.style.display="none",location.reload()}),1e3)}),2e3)):$utils.showToast("icon-toast-wrong","保存失败",2e3)})).catch((function(e){console.log(e)}))}))}))}();